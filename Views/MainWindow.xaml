<Window x:Class="LARS.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:LARS.ViewModels"
        xmlns:views="clr-namespace:LARS.Views"
        Title="LARS â€” Logistics Automation Report System"
        Width="1360" Height="860"
        MinWidth="960" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        Style="{StaticResource LarsWindow}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="56" />
            <RowDefinition Height="*" />
            <RowDefinition Height="36" />
        </Grid.RowDefinitions>

        <!-- ==================== íƒ€ì´í‹€ ë°” ==================== -->
        <Border Grid.Row="0" Background="{StaticResource HeaderGradientBrush}"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
            <Grid Margin="20,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- ë¡œê³  -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Width="34" Height="34" CornerRadius="7"
                            Background="{StaticResource AccentGradientBrush}" Margin="0,0,12,0">
                        <TextBlock Text="L" FontSize="18" FontWeight="Bold"
                                   Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" />
                    </Border>
                <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="LARS" FontSize="18" FontWeight="Bold"
                                   Foreground="{StaticResource TextPrimaryBrush}" />
                        <TextBlock Text="Logistics Automation Report System" FontSize="10"
                                   Foreground="{StaticResource TextMutedBrush}" Margin="0,-2,0,0" />
                    </StackPanel>
                </StackPanel>

                <!-- ì˜¤ë¥¸ìª½ ë²„íŠ¼: ê°±ì‹  -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Style="{StaticResource PrimaryButton}" Content="ðŸ”„ ì „ì²´ ê°±ì‹ "
                            Command="{Binding RefreshAllCommand}" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- ==================== ë©”ì¸ ì½˜í…ì¸  ==================== -->
        <TabControl Grid.Row="1" SelectedIndex="{Binding SelectedTabIndex}" Margin="0">

            <!-- ===== AutoReport íƒ­ ===== -->
            <TabItem Header="ðŸ“Š AutoReport">
                <TabControl Margin="4,4,4,0">

                    <!-- 1. Documents í•˜ìœ„íƒ­ ê·¸ë£¹ -->
                    <TabItem Header="ðŸ“„ Documents">
                        <TabControl Margin="4,4,4,0">

                            <!-- ===== BOM í•˜ìœ„íƒ­ ===== -->
                            <TabItem Header="ðŸ“‹ BOM">
                <Grid Margin="20,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- ì•¡ì…˜ ë°” -->
                    <Border Grid.Row="0" Style="{StaticResource CardPanel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="BOM (Bill of Materials)" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}" />
                                <TextBlock Text="{Binding BomInfoText, StringFormat='  â€¢  {0}'}"
                                           FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0" />
                            </StackPanel>
                            <Button Grid.Column="1" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ“¡ ìŠ¤ìº”" Command="{Binding ScanBomFilesCommand}" Margin="0,0,6,0" />
                            <Button Grid.Column="2" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ“‚ íŒŒì¼ ì—´ê¸°" Command="{Binding OpenBomFileCommand}" Margin="0,0,6,0" />
                            <Button Grid.Column="3" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ§© ì—ë””í„°" Command="{Binding OpenMacroEditorCommand}"
                                    ToolTip="ë§¤í¬ë¡œ íŒŒì´í”„ë¼ì¸(VME) ì—´ê¸°" Margin="0,0,6,0" />
                            <Button Grid.Column="4" Style="{StaticResource PrimaryButton}"
                                    Content="ðŸ“„ PDF" Command="{Binding ExportBomPdfCommand}" />
                        </Grid>
                    </Border>

                    <!-- í•˜ë‹¨ ë ˆì´ì•„ì›ƒ: ì¢Œì¸¡ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ / ì¤‘ì•™ ìŠ¤í”Œë¦¬í„° / ìš°ì¸¡ ë°ì´í„° ë·°ì–´ -->
                    <Grid Grid.Row="1" Grid.RowSpan="2" Margin="0,8,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="250" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- ì¢Œì¸¡: íŒŒì¼ ë¦¬ìŠ¤íŠ¸ -->
                        <Border Grid.Column="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="4">
                            <DataGrid ItemsSource="{Binding BomFiles}" SelectedItem="{Binding SelectedBomFile}" Margin="0">
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="ðŸ‘ï¸ ì˜¤ë¥¸ìª½ ë¯¸ë¦¬ë³´ê¸°ì— ë„ìš°ê¸°" Command="{Binding PreviewSelectedBomCommand}" />
                                        <MenuItem Header="âœï¸ ì—‘ì…€ë¡œ ì›ë³¸ ì—´ê¸°" Command="{Binding EditSelectedBomCommand}" />
                                        <Separator />
                                        <MenuItem Header="ðŸ—‘ï¸ ì›ë³¸ íŒŒì¼ ì™„ì „ ì‚­ì œ (ë¬¼ë¦¬ì  ì‚­ì œ)" Command="{Binding DeleteSelectedBomCommand}" Foreground="Red" />
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="íŒŒì¼ëª…" Binding="{Binding FileName}" Width="*" />
                                    <DataGridTextColumn Header="ìƒíƒœ" Binding="{Binding Status}" Width="80" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>

                        <!-- ì¤‘ê°„: ìŠ¤í”Œë¦¬í„° -->
                        <GridSplitter Grid.Column="1" Width="4" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="Transparent" Margin="2,0"/>

                        <!-- ìš°ì¸¡: ë°ì´í„° í”„ë¦¬ë·° -->
                        <Border Grid.Column="2" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="4">
                            <DataGrid ItemsSource="{Binding BomDataTable}"
                                      AutoGenerateColumns="True" IsReadOnly="True" Margin="0" />
                        </Border>
                    </Grid>
                </Grid>
                    </TabItem>

                    <!-- ===== DailyPlan í•˜ìœ„íƒ­ ===== -->
                    <TabItem Header="ðŸ“… DailyPlan">
                <Grid Margin="20,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Style="{StaticResource CardPanel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="DailyPlan (ìƒì‚° ê³„íšì„œ)" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}" />
                                <TextBlock Text="{Binding DpInfoText, StringFormat='  â€¢  {0}'}"
                                           FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0" />
                            </StackPanel>
                            <Button Grid.Column="1" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ“¡ ìŠ¤ìº”" Command="{Binding ScanDailyPlanFilesCommand}" Margin="0,0,6,0" />
                            <Button Grid.Column="2" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ“‚ íŒŒì¼ ì—´ê¸°" Command="{Binding OpenDailyPlanFileCommand}" Margin="0,0,6,0" />
                            <Button Grid.Column="3" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ§© ì—ë””í„°" Command="{Binding OpenMacroEditorCommand}"
                                    ToolTip="ë§¤í¬ë¡œ íŒŒì´í”„ë¼ì¸(VME) ì—´ê¸°" Margin="0,0,6,0" />
                            <Button Grid.Column="4" Style="{StaticResource PrimaryButton}"
                                    Content="ðŸ“„ PDF" Command="{Binding ExportDpPdfCommand}" />
                        </Grid>
                    </Border>

                    <!-- í•˜ë‹¨ ë ˆì´ì•„ì›ƒ: ì¢Œì¸¡ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ / ì¤‘ì•™ ìŠ¤í”Œë¦¬í„° / ìš°ì¸¡ ë°ì´í„° ë·°ì–´ -->
                    <Grid Grid.Row="1" Grid.RowSpan="2" Margin="0,8,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="250" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- ì¢Œì¸¡: íŒŒì¼ ë¦¬ìŠ¤íŠ¸ -->
                        <Border Grid.Column="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="4">
                            <DataGrid ItemsSource="{Binding DailyPlanFiles}" SelectedItem="{Binding SelectedDailyPlanFile}" Margin="0">
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="ðŸ‘ï¸ ì˜¤ë¥¸ìª½ ë¯¸ë¦¬ë³´ê¸°ì— ë„ìš°ê¸°" Command="{Binding PreviewSelectedDailyPlanCommand}" />
                                        <MenuItem Header="âœï¸ ì—‘ì…€ë¡œ ì›ë³¸ ì—´ê¸°" Command="{Binding EditSelectedDailyPlanCommand}" />
                                        <Separator />
                                        <MenuItem Header="ðŸ—‘ï¸ ì›ë³¸ íŒŒì¼ ì™„ì „ ì‚­ì œ (ë¬¼ë¦¬ì  ì‚­ì œ)" Command="{Binding DeleteSelectedDailyPlanCommand}" Foreground="Red" />
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="íŒŒì¼ëª…" Binding="{Binding FileName}" Width="*" />
                                    <DataGridTextColumn Header="ë‚ ì§œ" Binding="{Binding DateValue, StringFormat=yyyy-MM-dd}" Width="80" />
                                    <DataGridTextColumn Header="ìš”ì¼" Binding="{Binding WeekdayKorean}" Width="40" />
                                    <DataGridTextColumn Header="ë¼ì¸" Binding="{Binding Line}" Width="60" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>

                        <!-- ì¤‘ê°„: ìŠ¤í”Œë¦¬í„° -->
                        <GridSplitter Grid.Column="1" Width="4" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="Transparent" Margin="2,0"/>

                        <!-- ìš°ì¸¡: ë°ì´í„° í”„ë¦¬ë·° -->
                        <Border Grid.Column="2" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="4">
                            <DataGrid ItemsSource="{Binding DailyPlanDataTable}"
                                      AutoGenerateColumns="True" IsReadOnly="True" Margin="0" />
                        </Border>
                    </Grid>
                </Grid>
                    </TabItem>

                    <!-- ===== PartList í•˜ìœ„íƒ­ ===== -->
                    <TabItem Header="ðŸ“¦ PartList">
                <Grid Margin="20,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Style="{StaticResource CardPanel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="PartList (ìžìž¬ ëª©ë¡)" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}" />
                                <TextBlock Text="{Binding PlInfoText, StringFormat='  â€¢  {0}'}"
                                           FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0" />
                            </StackPanel>
                            <Button Grid.Column="1" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ“¡ ìŠ¤ìº”" Command="{Binding ScanPartListFilesCommand}" Margin="0,0,6,0" />
                            <Button Grid.Column="2" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ“‚ íŒŒì¼ ì—´ê¸°" Command="{Binding OpenPartListFileCommand}" Margin="0,0,6,0" />
                            <Button Grid.Column="3" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ”§ ì •ê·œí™”" Command="{Binding NormalizePartListCommand}"
                                    ToolTip="ìžìž¬ ì…€ì„ [ë²¤ë”] íŒŒíŠ¸ë²ˆí˜¸(ìˆ˜ëŸ‰) í‘œì¤€ í˜•ì‹ìœ¼ë¡œ ì •ê·œí™”"
                                    Margin="0,0,6,0" />
                            <Button Grid.Column="4" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ”© Feeder í•„í„°" Command="{Binding ApplyFeederFilterCommand}"
                                    ToolTip="Feeder íƒ­ì—ì„œ ì„ íƒí•œ Feederì˜ ì»¬ëŸ¼ë§Œ í‘œì‹œ"
                                    Margin="0,0,6,0" />
                            <Button Grid.Column="5" Style="{StaticResource SecondaryButton}"
                                    Content="â†© ì›ë³¸" Command="{Binding ResetToRawCommand}"
                                    ToolTip="ì •ê·œí™”/í•„í„° ì „ ì›ë³¸ ë°ì´í„°ë¡œ ë³µì›"
                                    Margin="0,0,6,0" />
                            <Button Grid.Column="6" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ§© ì—ë””í„°" Command="{Binding OpenMacroEditorCommand}"
                                    ToolTip="ë§¤í¬ë¡œ íŒŒì´í”„ë¼ì¸(VME) ì—´ê¸°" Margin="0,0,6,0" />
                            <Button Grid.Column="7" Style="{StaticResource PrimaryButton}"
                                    Content="ðŸ“„ PDF" Command="{Binding ExportPlPdfCommand}" />
                        </Grid>
                    </Border>

                    <!-- í•˜ë‹¨ ë ˆì´ì•„ì›ƒ: ì¢Œì¸¡ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ / ì¤‘ì•™ ìŠ¤í”Œë¦¬í„° / ìš°ì¸¡ ë°ì´í„° ë·°ì–´ -->
                    <Grid Grid.Row="1" Grid.RowSpan="2" Margin="0,8,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="250" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- ì¢Œì¸¡: íŒŒì¼ ë¦¬ìŠ¤íŠ¸ -->
                        <Border Grid.Column="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="4">
                            <DataGrid ItemsSource="{Binding PartListFiles}" SelectedItem="{Binding SelectedPartListFile}" Margin="0">
                                <DataGrid.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="ðŸ‘ï¸ ì˜¤ë¥¸ìª½ ë¯¸ë¦¬ë³´ê¸°ì— ë„ìš°ê¸°" Command="{Binding PreviewSelectedPartListCommand}" />
                                        <MenuItem Header="âœï¸ ì—‘ì…€ë¡œ ì›ë³¸ ì—´ê¸°" Command="{Binding EditSelectedPartListCommand}" />
                                        <Separator />
                                        <MenuItem Header="ðŸ—‘ï¸ ì›ë³¸ íŒŒì¼ ì™„ì „ ì‚­ì œ (ë¬¼ë¦¬ì  ì‚­ì œ)" Command="{Binding DeleteSelectedPartListCommand}" Foreground="Red" />
                                    </ContextMenu>
                                </DataGrid.ContextMenu>
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="íŒŒì¼ëª…" Binding="{Binding FileName}" Width="*" />
                                    <DataGridTextColumn Header="ë‚ ì§œ" Binding="{Binding DateValue, StringFormat=yyyy-MM-dd}" Width="80" />
                                    <DataGridTextColumn Header="ë¼ì¸" Binding="{Binding Line}" Width="60" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>

                        <!-- ì¤‘ê°„: ìŠ¤í”Œë¦¬í„° -->
                        <GridSplitter Grid.Column="1" Width="4" HorizontalAlignment="Center" VerticalAlignment="Stretch" Background="Transparent" Margin="2,0"/>

                        <!-- ìš°ì¸¡: ë°ì´í„° í”„ë¦¬ë·° -->
                        <Border Grid.Column="2" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="4">
                            <DataGrid ItemsSource="{Binding PartListDataTable}"
                                      AutoGenerateColumns="True" IsReadOnly="True" Margin="0" />
                        </Border>
                    </Grid>
                </Grid>
                    </TabItem>

                    <!-- ===== MultiDocuments í•˜ìœ„íƒ­ ===== -->
                    <TabItem Header="ðŸ”— êµì°¨ ë§¤í•‘">
                <Grid Margin="20,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Style="{StaticResource CardPanel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="BD_MultiDocuments (êµì°¨ ë§¤í•‘ ìžë™í™”)" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}" />
                                <TextBlock Text="{Binding MdInfoText, StringFormat='  â€¢  {0}'}"
                                           FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0" />
                            </StackPanel>
                            <Button Grid.Column="1" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ“¡ ê²°ê³¼ ìŠ¤ìº”" Command="{Binding LoadMultiDocumentsCommand}" Margin="0,0,6,0" />
                            <Button Grid.Column="2" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ§© ì—ë””í„°" Command="{Binding OpenMacroEditorCommand}"
                                    ToolTip="ë§¤í¬ë¡œ íŒŒì´í”„ë¼ì¸(VME) ì—´ê¸°" Margin="0,0,6,0" />
                            <Button Grid.Column="3" Style="{StaticResource PrimaryButton}"
                                    Content="ðŸš€ ì¼ê´„ ì²˜ë¦¬ (ì •ê·œí™”+PDF)" Command="{Binding ProcessMultiDocumentsCommand}" />
                        </Grid>
                    </Border>

                    <!-- ë§¤í•‘ëœ ê·¸ë£¹ ë¦¬ìŠ¤íŠ¸ -->
                    <DataGrid Grid.Row="1" ItemsSource="{Binding MultiDocuments}"
                              AutoGenerateColumns="False" IsReadOnly="False" Margin="0,4,0,0">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="ì„ íƒ" Binding="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}" Width="50" />
                            <DataGridTextColumn Header="í‚¤ (Date_Line)" Binding="{Binding Key}" Width="150" IsReadOnly="True" />
                            <DataGridTextColumn Header="DailyPlan" Binding="{Binding DailyPlanName}" Width="250" IsReadOnly="True" />
                            <DataGridTextColumn Header="PartList" Binding="{Binding PartListName}" Width="250" IsReadOnly="True" />
                            <DataGridCheckBoxColumn Header="ë§¤ì¹­ ì™„ë£Œ" Binding="{Binding HasBoth, Mode=OneWay}" Width="80" IsReadOnly="True" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
                    </TabItem>

                    <!-- ===== ItemCounter í•˜ìœ„íƒ­ ===== -->
                    <TabItem Header="ðŸ”¢ ItemCounter">
                <Grid Margin="20,16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Style="{StaticResource CardPanel}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <TextBlock Text="ItemCounter (ìžìž¬ ì¹´ìš´í„°)" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}" />
                                <TextBlock Text="{Binding IcInfoText, StringFormat='  â€¢  {0}'}"
                                           FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                           VerticalAlignment="Center" Margin="8,0,0,0" />
                            </StackPanel>
                            <Button Grid.Column="1" Style="{StaticResource SecondaryButton}"
                                    Content="ðŸ§© ì—ë””í„°" Command="{Binding OpenMacroEditorCommand}"
                                    ToolTip="ë§¤í¬ë¡œ íŒŒì´í”„ë¼ì¸(VME) ì—´ê¸°" Margin="0,0,6,0" />
                            <Button Grid.Column="2" Style="{StaticResource PrimaryButton}"
                                    Content="â–¶ ì§‘ê³„ ì‹¤í–‰" Command="{Binding RunItemCounterCommand}" />
                        </Grid>
                    </Border>

                    <DataGrid Grid.Row="1" ItemsSource="{Binding ItemCounterDataTable}"
                              AutoGenerateColumns="True" IsReadOnly="True" Margin="0,4,0,0" />
                </Grid>
                    </TabItem>

                        </TabControl>
                    </TabItem>

                    <!-- 2. Basic info í•˜ìœ„íƒ­ ê·¸ë£¹ -->
                    <TabItem Header="âš™ï¸ Basic info">
                        <TabControl Margin="4,4,4,0">

                            <!-- ===== Feeder í•˜ìœ„íƒ­ ===== -->
                            <TabItem Header="ðŸ”§ Feeder">
                <Grid Margin="20,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="320" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- ì™¼ìª½: Feeder ë¦¬ìŠ¤íŠ¸ -->
                    <Grid Grid.Column="0" Margin="0,0,16,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardPanel}" Padding="12">
                            <StackPanel>
                                <TextBlock Text="Feeder ê´€ë¦¬" FontSize="16" FontWeight="Bold"
                                           Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,4" />
                                <TextBlock Text="{Binding FeederInfoText}" FontSize="11"
                                           Foreground="{StaticResource TextMutedBrush}" />
                            </StackPanel>
                        </Border>

                        <!-- ìƒˆ Feeder ì¶”ê°€ -->
                        <Border Grid.Row="1" Style="{StaticResource CardPanel}" Padding="12">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBox Text="{Binding NewFeederName, UpdateSourceTrigger=PropertyChanged}"
                                         Margin="0,0,6,0" />
                                <Button Grid.Column="1" Style="{StaticResource PrimaryButton}"
                                        Content="ì¶”ê°€" Padding="12,6"
                                        Command="{Binding AddFeederCommand}" />
                            </Grid>
                        </Border>

                        <!-- Feeder ëª©ë¡ -->
                        <ListBox Grid.Row="2"
                                 ItemsSource="{Binding Feeders}"
                                 SelectedItem="{Binding SelectedFeeder}"
                                 DisplayMemberPath="Name"
                                 Background="{StaticResource SurfaceBrush}"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 BorderBrush="{StaticResource BorderBrush}" BorderThickness="1"
                                 Margin="0,4,0,0" />

                        <Button Grid.Row="3" Style="{StaticResource SecondaryButton}"
                                Content="ðŸ—‘ ì„ íƒ ì‚­ì œ" Margin="0,8,0,0"
                                Command="{Binding RemoveFeederCommand}" />
                    </Grid>

                    <!-- ì˜¤ë¥¸ìª½: Feeder ì•„ì´í…œ -->
                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardPanel}" Padding="12">
                            <TextBlock FontSize="15" FontWeight="Bold" Foreground="{StaticResource AccentBrush}">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="Feeder: {0}">
                                        <Binding Path="SelectedFeeder.Name" FallbackValue="(ì„ íƒ ì—†ìŒ)" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </Border>

                        <!-- ì•„ì´í…œ ì¶”ê°€ -->
                        <Border Grid.Row="1" Style="{StaticResource CardPanel}" Padding="12">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBox Text="{Binding NewFeederItem, UpdateSourceTrigger=PropertyChanged}"
                                         Margin="0,0,6,0" />
                                <Button Grid.Column="1" Style="{StaticResource PrimaryButton}"
                                        Content="ì•„ì´í…œ ì¶”ê°€" Padding="12,6"
                                        Command="{Binding AddFeederItemCommand}" />
                            </Grid>
                        </Border>

                        <!-- ì•„ì´í…œ ëª©ë¡ -->
                        <ListBox Grid.Row="2"
                                 ItemsSource="{Binding SelectedFeeder.Items}"
                                 Background="{StaticResource SurfaceBrush}"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 BorderBrush="{StaticResource BorderBrush}" BorderThickness="1"
                                 Margin="0,4,0,0" />
                    </Grid>
                </Grid>
                            </TabItem>

                        </TabControl>
                    </TabItem>
                </TabControl>
            </TabItem>


            <!-- ===== ì„¤ì • ìµœìƒìœ„ íƒ­ ===== -->
            <TabItem Header="âš™ï¸ ì„¤ì •">
                <TabControl Margin="4,4,4,0">
                    <!-- 1. ê¸°ë³¸/ì •ë³´ íƒ­ -->
                    <TabItem Header="ê¸°ë³¸ ì •ë³´">
                        <Grid Margin="20,16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Style="{StaticResource CardPanel}" Margin="0,0,0,16">
                                <StackPanel>
                                    <TextBlock Text="ðŸ“ ë£¨íŠ¸ ìž‘ì—… ë””ë ‰í† ë¦¬ ì§€ì •" FontSize="16" FontWeight="Bold"
                                               Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,12" />
                                    <TextBlock Text="ëª¨ë“  íŒŒì¼ì€ ì´ í´ë” í•˜ìœ„ì˜ 'LARS_Documents' ë‚´ë¶€ì—ì„œ ì•ˆì „í•˜ê²Œ ê´€ë¦¬ë©ë‹ˆë‹¤." 
                                               Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,8" FontSize="12"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <TextBox Grid.Column="0" Text="{Binding BasePath, Mode=TwoWay}"
                                                 IsReadOnly="True" Margin="0,0,8,0" />
                                        <Button Grid.Column="1" Style="{StaticResource SecondaryButton}"
                                                Content="ë³€ê²½..." Command="{Binding BrowseBasePathCommand}" />
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <Border Grid.Row="1" Style="{StaticResource CardPanel}">
                                <StackPanel>
                                    <TextBlock Text="â„¹ï¸ ì•± ì •ë³´" FontSize="16" FontWeight="Bold"
                                               Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,12" />
                                    <TextBlock Foreground="{StaticResource TextSecondaryBrush}" FontSize="12">
                                        <Run Text="LARS v1.1" FontWeight="Bold" Foreground="{StaticResource AccentBrush}" />
                                        <LineBreak />
                                        <Run Text="Logistics Automation Report System â€” C# WPF Edition" />
                                        <LineBreak />
                                        <Run Text=".NET 8.0 | ClosedXML | PdfSharpCore | CommunityToolkit.Mvvm" />
                                        <LineBreak />
                                        <Run Text="ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬: MIT ë¼ì´ì„ ìŠ¤" Foreground="{StaticResource SuccessBrush}" />
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </TabItem>

                    <!-- 2. ì„¸ë¶€ ê²½ë¡œ ê´€ë¦¬ íƒ­ -->
                    <TabItem Header="ê²½ë¡œ ê´€ë¦¬ (ê³ ê¸‰)">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="20,16">
                                <TextBlock Text="ê²½ë¡œë“¤ì„ ë¹„ì›Œë‘˜ ê²½ìš°, Source(ìŠ¤ìº”)ëŠ” 'ê¸°ë³¸ ê²½ë¡œ(ë˜ëŠ” ë‹¤ìš´ë¡œë“œ í´ë”)'ë¥¼, Output(ì¶œë ¥)ì€ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ ë‚´ë¶€ í´ë”ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤."
                                           Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,16" FontSize="13" FontStyle="Italic" TextWrapping="Wrap"/>

                                <!-- Source ê²½ë¡œ ì„¤ì • -->
                                <Border Style="{StaticResource CardPanel}" Margin="0,0,0,16">
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“¥ ìŠ¤ìº” ì›ë³¸(Source) í´ë” ì§€ì •" FontSize="16" FontWeight="Bold"
                                                   Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,12" />

                                        <Border Background="{StaticResource SecondaryDarkBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="4" Padding="12" Margin="0,0,0,16">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="80"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="60"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Text="ê¸°ë³¸ ê²½ë¡œ" ToolTip="ê°œë³„ ë¬¸ì„œ ìŠ¤ìº” ê²½ë¡œê°€ ë¹„ì–´ìžˆì„ ë•Œ ê³µí†µìœ¼ë¡œ ì ìš©ë˜ëŠ” ì „ì—­ ê¸°ë³¸ ìŠ¤ìº”(Source) ê²½ë¡œìž…ë‹ˆë‹¤." VerticalAlignment="Center" FontWeight="Bold" Foreground="{StaticResource AccentBrush}"/>
                                                <TextBox Grid.Column="1" Text="{Binding SettingsDefaultSourcePath, Mode=TwoWay}" IsReadOnly="True" Margin="0,0,8,0" />
                                                <Button Grid.Column="2" Content="ì„ íƒ" Command="{Binding BrowsePathCommand}" CommandParameter="DefaultSource" Style="{StaticResource PrimaryButton}"/>
                                            </Grid>
                                        </Border>

                                        <Grid Margin="0,0,0,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="60"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="BOM" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                            <TextBox Grid.Column="1" Text="{Binding SettingsSourceBom, Mode=TwoWay}" IsReadOnly="True" Margin="0,0,8,0" />
                                            <Button Grid.Column="2" Content="ì„ íƒ" Command="{Binding BrowsePathCommand}" CommandParameter="SourceBOM" Style="{StaticResource SecondaryButton}"/>
                                        </Grid>

                                        <Grid Margin="0,0,0,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="60"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="DailyPlan" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                            <TextBox Grid.Column="1" Text="{Binding SettingsSourceDailyPlan, Mode=TwoWay}" IsReadOnly="True" Margin="0,0,8,0" />
                                            <Button Grid.Column="2" Content="ì„ íƒ" Command="{Binding BrowsePathCommand}" CommandParameter="SourceDP" Style="{StaticResource SecondaryButton}"/>
                                        </Grid>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="60"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="PartList" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                            <TextBox Grid.Column="1" Text="{Binding SettingsSourcePartList, Mode=TwoWay}" IsReadOnly="True" Margin="0,0,8,0" />
                                            <Button Grid.Column="2" Content="ì„ íƒ" Command="{Binding BrowsePathCommand}" CommandParameter="SourcePL" Style="{StaticResource SecondaryButton}"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <!-- Output ê²½ë¡œ ì„¤ì • -->
                                <Border Style="{StaticResource CardPanel}">
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“¤ ì¶œë ¥(Output)/ì‹œìŠ¤í…œ í´ë” ì§€ì •" FontSize="16" FontWeight="Bold"
                                                   Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,12" />

                                        <Grid Margin="0,0,0,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="60"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="BOM ì¶œë ¥" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                            <TextBox Grid.Column="1" Text="{Binding SettingsOutputBom, Mode=TwoWay}" IsReadOnly="True" Margin="0,0,8,0" />
                                            <Button Grid.Column="2" Content="ì„ íƒ" Command="{Binding BrowsePathCommand}" CommandParameter="OutBOM" Style="{StaticResource SecondaryButton}"/>
                                        </Grid>

                                        <Grid Margin="0,0,0,8">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="60"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="DailyPlan" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                            <TextBox Grid.Column="1" Text="{Binding SettingsOutputDailyPlan, Mode=TwoWay}" IsReadOnly="True" Margin="0,0,8,0" />
                                            <Button Grid.Column="2" Content="ì„ íƒ" Command="{Binding BrowsePathCommand}" CommandParameter="OutDP" Style="{StaticResource SecondaryButton}"/>
                                        </Grid>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="60"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBlock Text="PartList" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                            <TextBox Grid.Column="1" Text="{Binding SettingsOutputPartList, Mode=TwoWay}" IsReadOnly="True" Margin="0,0,8,0" />
                                            <Button Grid.Column="2" Content="ì„ íƒ" Command="{Binding BrowsePathCommand}" CommandParameter="OutPL" Style="{StaticResource SecondaryButton}"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>

                    <!-- 3. Performance íƒ­ -->
                    <TabItem Header="ðŸš€ Performance (ê³ ê¸‰)">
                        <Grid Margin="20,16">
                            <Border Style="{StaticResource CardPanel}" VerticalAlignment="Top">
                                <StackPanel>
                                    <TextBlock Text="ðŸš€ ë‹¤ì¤‘ ì½”ì–´ ì²˜ë¦¬ (Multi-core Computing)" FontSize="18" FontWeight="Bold"
                                               Foreground="{StaticResource TextPrimaryBrush}" Margin="0,0,0,12" />
                                    <TextBlock Text="ì‹¤ë¬´ í™˜ê²½ì—ì„œ í•œ ë²ˆì— ìŸì•„ì§€ëŠ” ë§‰ëŒ€í•œ ì–‘ì˜ ë¬¸ì„œë¥¼ ì§€ì—° ì—†ì´ ì¦‰ê°ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ê°€ê³µí•  ìˆ˜ ìžˆë„ë¡ ì§€ì›í•˜ëŠ” ê³ ì† ë³‘ë ¬ ì²˜ë¦¬ ëª¨ë“ˆìž…ë‹ˆë‹¤." 
                                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="13" TextWrapping="Wrap" />
                                </StackPanel>
                            </Border>
                        </Grid>
                    </TabItem>
                </TabControl>
            </TabItem>
        </TabControl>

        <!-- ==================== ìƒíƒœ ë°” ==================== -->
        <Border Grid.Row="2" Background="{StaticResource SecondaryDarkBrush}"
                BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0">
            <Grid Margin="16,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{Binding StatusText}"
                           VerticalAlignment="Center" FontSize="12"
                           Foreground="{StaticResource TextSecondaryBrush}" />

                <TextBlock Grid.Column="1" Text="LARS v1.0 | .NET 8 WPF"
                           VerticalAlignment="Center" FontSize="11"
                           Foreground="{StaticResource TextMutedBrush}" />
            </Grid>
        </Border>
    </Grid>
</Window>
