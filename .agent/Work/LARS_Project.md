# LARS í”„ë¡œì íŠ¸ ê¸°íšì„œ

> **LARS** = **L**ogistics **A**utomation **R**eport **S**ystem
> ëª©ì ì§€í–¥í˜• ë¬¼ë¥˜ ì¢…í•©(ëª¨ë‹ˆí„°ë§ ë° ê¸°íš, ë³´ê³ ì„œ ìƒì„±) ì‹œìŠ¤í…œ
> **AutoReport** = **Auto**matic **Report**
> ìƒì‚° ë¼ì¸ì˜ BOM / DailyPlan / PartList ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ê°€ê³µÂ·ì‹œê°í™”Â·ì¸ì‡„í•˜ëŠ” ë³´ê³ ì„œ ëª¨ë“ˆ

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1. ë°°ê²½
ê¸°ì¡´ì— **Excel VBA ë§¤í¬ë¡œ**ë¡œ ìš´ì˜ë˜ë˜ ìƒì‚° ë¼ì¸ ë³´ê³ ì„œ ìë™í™” ë„êµ¬ë¥¼
**Windows ë°ìŠ¤í¬í†± ì• í”Œë¦¬ì¼€ì´ì…˜(WPF + C#)** ìœ¼ë¡œ ì¬êµ¬í˜„í•˜ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

### 1.2. ëª©ì 
- VBA/Excel COM ì˜ì¡´ì„± ì œê±° â†’ ë…ë¦½ ì‹¤í–‰í˜• ì• í”Œë¦¬ì¼€ì´ì…˜
- ìœ ì§€ë³´ìˆ˜ì„±Â·í™•ì¥ì„± í–¥ìƒ (MVVM ì•„í‚¤í…ì²˜, DI, ì„œë¹„ìŠ¤ ë¶„ë¦¬)
- PDF ì§ì ‘ ì¶œë ¥ (Excel ì¸ì‡„ ê¸°ëŠ¥ ë¶ˆí•„ìš”)
- í–¥í›„ ì›¹ ëŒ€ì‹œë³´ë“œÂ·DB ì—°ë™ ë“± í™•ì¥ ê°€ëŠ¥í•œ êµ¬ì¡°

### 1.3. ëŒ€ìƒ ì‚¬ìš©ì
- ìƒì‚°ê´€ë¦¬ ë‹´ë‹¹ì (í˜„ì¥ ë¼ì¸ ë³´ê³ ì„œ ì¶œë ¥)
- ìì¬ê´€ë¦¬ ë‹´ë‹¹ì (PartList ê¸°ë°˜ ìì¬ ì§‘ê³„)
- ë¬¼ë¥˜ê´€ë¦¬ ë‹´ë‹¹ì (PartList ê¸°ë°˜ ìì¬ ê³µê¸‰ ë° ê³µëŒ€ì°¨ ë°°ì¶œ ê³„íš)

---

## 2. í•µì‹¬ ê¸°ëŠ¥

### 2.1. BOM Viewer
- **ì…ë ¥**: `@CVZ` íŒ¨í„´ì´ í¬í•¨ëœ Excel íŒŒì¼ (SAP BOM Export)
- **ì²˜ë¦¬**: ë¶ˆí•„ìš” ì—´ ì‚­ì œ, BOM Level í•„í„°ë§(0/1/2/3/S/Q), ëª¨ë¸ëª… ìë™ ì¶”ì¶œ
- **ì¶œë ¥**: ê°€ê³µëœ BOM í‘œì‹œ + PDF ì¶œë ¥

### 2.2. DailyPlan Viewer
- **ì…ë ¥**: `Excel_Export_` íŒ¨í„´ íŒŒì¼ (MES DailyPlan Export)
- **ì²˜ë¦¬**: ë‚ ì§œ/ë¼ì¸ ë©”íƒ€ íŒŒì‹±, ë¶ˆí•„ìš” ì—´ ì‚­ì œ, ëª¨ë¸ ê·¸ë£¨í•‘(ModelGrouping), ì‹œê°í™”
- **ì¶œë ¥**: ëª¨ë¸ë³„ ê·¸ë£¹ ê²½ê³„ í‘œì‹œ + ìš”ì¼ ìƒ‰ìƒ + PDF ì¶œë ¥

### 2.3. PartList Viewer
- **ì…ë ¥**: `Excel_Export_` íŒ¨í„´ íŒŒì¼ (MES PartList Export)
- **ì²˜ë¦¬**: â˜… ê°€ì¥ ë³µì¡í•œ íŒŒì´í”„ë¼ì¸
  - íˆ¬ì…ì‹œì  ë³‘í•© (YYYYMMDD + Input Time)
  - D-Day Nì¼ íŠ¸ë¦¬ë°
  - ëª¨ë¸+Suffix ë³‘í•©, ë™ì¼ ë¶€í’ˆ ì—´ í•©ì¹˜ê¸°(PartCombine)
  - ì¤‘ë³µ W/O í–‰ ì œê±°+í•©ì‚°, ë²¤ë”ëª… ì •ê·œí™”(Replacing_Parts)
  - Feeder ê¸°ë°˜ ì»¬ëŸ¼ í•„í„°ë§
- **ì¶œë ¥**: ì •ê·œí™”ëœ PartList í‘œì‹œ + PDF ì¶œë ¥

### 2.4. ItemCounter
- **ì…ë ¥**: ê°€ê³µëœ PartList ë°ì´í„°
- **ì²˜ë¦¬**: ì…€ í…ìŠ¤íŠ¸ â†’ itemUnit ë¶„í•´ (Re_Categorizing), ID_Hash ê¸°ì¤€ ë³‘í•©, ë‚ ì§œë³„ Count ì§‘ê³„
- **ì¶œë ¥**: ìì¬ë³„ ë‚ ì§œë³„ íˆ¬ì… ìˆ˜ëŸ‰ í…Œì´ë¸”

### 2.5. MultiDocuments
- **ì…ë ¥**: DailyPlan + PartList íŒŒì¼ í´ë”
- **ì²˜ë¦¬**: íŒŒì¼ëª…ì—ì„œ ë‚ ì§œ+ë¼ì¸ ì¶”ì¶œ â†’ êµì§‘í•© ë§¤í•‘
- **ì¶œë ¥**: ë§¤ì¹­ëœ ë¬¸ì„œ ìŒ ListView + ì¼ê´„ ì²˜ë¦¬

### 2.6. Performance (Multi-core Computing)
- **ê°œìš”**: ì‹¤ë¬´ í™˜ê²½ì—ì„œ ë°œìƒí•˜ëŠ” ê±°ëŒ€í•œ ì–‘ì˜ ë¬¸ì„œ(ìˆ˜ì‹­~ìˆ˜ë°± ê°œ)ë¥¼ í•œ ë²ˆì— ì¦‰ê°ì ìœ¼ë¡œ ì¸ì‹í•˜ê³  ê°€ê³µí•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ë³‘ë ¬ ì²˜ë¦¬ ì•„í‚¤í…ì²˜ ì§€ì›.
- **íŠ¹ì§•**: ìŠ¤ë ˆë“œ ë° ì½”ì–´ ìì›ì„ ìµœëŒ€í•œ í™œìš©í•˜ì—¬ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°ì´í„°ë¥¼ ë¶„ì‚° ì²˜ë¦¬í•¨ìœ¼ë¡œì¨ UIì˜ ë©ˆì¶¤ í˜„ìƒì„ ë°©ì§€í•˜ê³  ì‘ì—… ì†Œìš” ì‹œê°„ì„ íšê¸°ì ìœ¼ë¡œ ì¤„ì´ëŠ” ê²ƒì´ ëª©í‘œ.

### 2.6. StickerLabel
- **ì…ë ¥**: ë¼ë²¨ ë°ì´í„° (ëª¨ë¸ëª…, W/O, ìˆ˜ëŸ‰ ë“±)
- **ì²˜ë¦¬**: A4 ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ ë¼ë²¨ ë°°ì¹˜
- **ì¶œë ¥**: PDF ë¼ë²¨ ì¸ì‡„

---

## 3. ê¸°ìˆ  ìŠ¤íƒ

| ì˜ì—­ | ê¸°ìˆ  | ë¹„ê³  |
|------|------|------|
| **ì–¸ì–´** | C# (.NET 8) | |
| **UI í”„ë ˆì„ì›Œí¬** | WPF | MVVM íŒ¨í„´ |
| **MVVM ë„êµ¬** | CommunityToolkit.Mvvm | RelayCommand, ObservableProperty |
| **DI** | Microsoft.Extensions.DependencyInjection | |
| **Excel ì½ê¸°** | ClosedXML | ì½ê¸° ì „ìš©, íŒŒì¼ ë³€ê²½ ì—†ìŒ |
| **PDF ì¶œë ¥** | PdfSharpCore | A4 ê¸°ì¤€ ë ˆì´ì•„ì›ƒ |
| **ì„¤ì • ì €ì¥** | JSON (`%AppData%/LARS/settings.json`) | SettingsService |
| **Feeder ì €ì¥** | JSON (`%AppData%/LARS/feeders.json`) | FeederService |

---

## 4. ì•„í‚¤í…ì²˜

```
LARS/
â”œâ”€â”€ Models/          â† ë°ì´í„° ëª¨ë¸ (ModelInfo, ItemUnit, Lot, ...)
â”œâ”€â”€ Services/        â† ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (ReportServices, PdfExportService, ...)
â”œâ”€â”€ ViewModels/      â† MVVM ViewModel (MainViewModel)
â”œâ”€â”€ Views/           â† WPF XAML (MainWindow, StickerLabelDialog)
â”œâ”€â”€ VBA/             â† VBA ì›ë³¸ ì†ŒìŠ¤ (ì°¸ì¡°ìš©)
â””â”€â”€ .agent/
    â”œâ”€â”€ Identity.md  â† ì—ì´ì „íŠ¸ í–‰ë™ ê°•ë ¹
    â””â”€â”€ Work/        â† ì—…ë¬´ ë¬¸ì„œ (ì´ íŒŒì¼ í¬í•¨)
```

### 4.1. í•µì‹¬ ì›ì¹™
- ì„œë¹„ìŠ¤ëŠ” **ìˆœìˆ˜ C#**, VBA/COM ì˜ì¡´ì„± ì—†ìŒ
- ëª¨ë“  I/O: **async/await + Task.Run**
- UIì™€ ë¡œì§ ë¶„ë¦¬: **MVVM** (ViewModel â†’ Service â†’ Model)
- Excel Shape ë“œë¡œì‰(VBA Painter/StickerLabel) â†’ **WPF DataGrid/Canvas + PDF ë Œë”ë§**ìœ¼ë¡œ ëŒ€ì²´

---

## 5. ì›ë³¸ ì°¸ì¡°

- **VBA ì›ë³¸ ì½”ë“œ**: `VBA/Original.md` (6,739ì¤„)
- **VBA ë¶„ì„ ë¦¬ë·°**: `.agent/Work/VBA_Review.md`
- **C# ì½”ë“œ ë¦¬ë·°**: `.agent/Work/Csharp_Review.md`
- **ì´ê´€ ê°œë°œ ê³„íš**: `.agent/Work/Migration_Plan.md`

---

## 6. ê°œë°œ ì§„í–‰ í˜„í™©

| ë‹¨ê³„ | ìƒíƒœ | ë‚´ìš© |
|------|------|------|
| Sprint 0~9 | âœ… ì™„ë£Œ | BOM/DailyPlan/PartList ê¸°ë³¸ ê¸°ëŠ¥, PDF ì¶œë ¥, ì„¤ì •/Feeder, ItemCounter, MultiDoc, StickerLabel |
| Sprint 10 | ğŸ”´ ëŒ€ê¸° | PartList í•µì‹¬ ê°€ê³µ íŒŒì´í”„ë¼ì¸ (AR_1 ì „ì²´) |
| Sprint 11 | ëŒ€ê¸° | ItemCounter íŒŒì‹± ì •ë°€ ê²€ì¦ |
| Sprint 12 | ëŒ€ê¸° | DailyPlan ê°€ê³µ + ModelGrouping |
| Sprint 13 | ëŒ€ê¸° | íŒŒì¼ ìœ íš¨ì„± ê²€ì¦ + BOM Level í•„í„° |
| Sprint 14 | ëŒ€ê¸° | VBAâ†”C# ì „ì²´ ëŒ€ì¡° ê²€ì¦ |

> ìƒì„¸ Sprint ë‚´ìš©: [Migration_Plan.md](file:///d:/Workshop/LARS/.agent/Work/Migration_Plan.md)
